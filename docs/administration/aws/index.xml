<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AWS on HortaCloud</title><link>https://hortacloud.org/docs/administration/aws/</link><description>Recent content in AWS on HortaCloud</description><generator>Hugo</generator><language>en</language><atom:link href="https://hortacloud.org/docs/administration/aws/index.xml" rel="self" type="application/rss+xml"/><item><title>Costs</title><link>https://hortacloud.org/docs/administration/aws/costs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/costs/</guid><description>&lt;p>Deploying this system on Amazon Web Services (AWS) incurs a monthly cost for AWS service usage.&lt;/p>
&lt;p>In particular, the cost breakdown is roughly:&lt;/p>
&lt;ul>
&lt;li>$382/mo - Per user costs for running the Horta client on AppStream&lt;/li>
&lt;li>$277/mo - Back-end services running on EC2 (with Savings Plan)&lt;/li>
&lt;li>$76/mo - Storage (3 TB) for one sample image on S3&lt;/li>
&lt;li>$34/mo - Virtual Private Cloud (VPC)&lt;/li>
&lt;/ul>
&lt;p>Therefore, the minimum total cost per month for a single user would be about $770 ($9,237/year). For 2 users, the monthly cost would be $1130 ($13,570/year), etc. The full estimate can be &lt;a href="https://calculator.aws/#/estimate?id=ecbba8c6713281bc419c70de414d8a1db19dd345">found here&lt;/a>.&lt;/p></description></item><item><title>Deployment</title><link>https://hortacloud.org/docs/administration/aws/deployment/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/deployment/</guid><description>&lt;p>The deployment uses AWS CDK to create AWS resources on your AWS account as shown in the diagram below. All services run in a secured Virtual Private Cloud (VPC).&lt;/p>

&lt;a href="../cloud_architecture.png">
 &lt;img 
 src="../cloud_architecture.png"
 class="rounded mx-auto"
 style="max-width: 800px;" 
 
 alt="cloud architecture diagram"/>
&lt;/a>
&lt;h2 id="install-prerequisites">Install prerequisites&lt;/h2>
&lt;p>You should have &lt;strong>node &amp;gt; v16&lt;/strong> installed on your local machine. We recommend using &lt;a href="https://github.com/nvm-sh/nvm">nvm&lt;/a> to install and activate this version of node.&lt;/p>
&lt;ul>
&lt;li>Install AWS CLI
&lt;ul>
&lt;li>AWS CDK requires AWS CLI to be installed and configured on the computer from which one runs the deployment procedure. &lt;a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">Installation&lt;/a> &amp;amp; &lt;a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">configuration&lt;/a> instructions can be found in the AWS documentation.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="get-the-deployment-scripts">Get the deployment scripts&lt;/h2>
&lt;p>Clone the &lt;a href="https://github.com/JaneliaSciComp/hortacloud">HortaCloud GitHib repository&lt;/a> containing the deployment scripts:&lt;/p></description></item><item><title>Backup &amp; Restore</title><link>https://hortacloud.org/docs/administration/aws/backups/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/backups/</guid><description>&lt;h2 id="system-backup">System backup&lt;/h2>
&lt;p>The system can be configured to take nightly backups. All it is needed is to specify a writeable bucket (&lt;code>HORTA_BACKUP_BUCKET&lt;/code>) that will hold the backups. You can also specify the base prefix for the backups using &lt;code>HORTA_BACKUP_FOLDER&lt;/code>. If this is not specified the prefix will default to &amp;ldquo;/hortacloud/backups&amp;rdquo;.&lt;/p>
&lt;p>Currently the backup contains the Cognito users and the Mongo database (user-generated metadata and tracing data). Each backup will be stored in a timestamp (with format &amp;ldquo;yyyyMMddHHmmss&amp;rdquo;) folder under the base backup prefix. The location of the backups will be &lt;code>s3://&amp;lt;backup_bucket&amp;gt;/&amp;lt;backup_folder_prefix&amp;gt;/&amp;lt;timestamp&amp;gt;/jacs&lt;/code> for the database and &lt;code>s3://&amp;lt;backup_bucket&amp;gt;/&amp;lt;backup_folder_prefix&amp;gt;/&amp;lt;timestamp&amp;gt;/cognito&lt;/code> for cognito users.&lt;/p></description></item><item><title>Upgrading</title><link>https://hortacloud.org/docs/administration/aws/upgrading/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/upgrading/</guid><description>&lt;p>There are two ways to upgrade to a new version of the code: &lt;a href="#full-upgrade">Full Upgrade&lt;/a> and &lt;a href="#incremental-upgrade">Incremental Upgrade&lt;/a>.&lt;/p>
&lt;h2 id="full-upgrade">Full Upgrade&lt;/h2>
&lt;p>This method backs up all of the data, removes the existing HortaCloud stack, installs a new version from scratch, and restores the data. This is currently the most automated way to upgrade, and requires the least amount of effort.&lt;/p>
&lt;h3 id="backup-your-data">Backup your data&lt;/h3>
&lt;p>First, ensure that you have a recent data backup. If you have not &lt;a href="../backups">configured backups&lt;/a>, do that first. For most upgrades, you only need to check if a backup for the JACS Mongo database exists. Typically this is located at &lt;code>s3://&amp;lt;HORTA_BACKUP_BUCKET value&amp;gt;/&amp;lt;HORTA_BACKUP_FOLDER value&amp;gt;/&amp;lt;timestamp&amp;gt;/jacs&lt;/code>&lt;/p></description></item><item><title>Data Import</title><link>https://hortacloud.org/docs/administration/aws/data/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/data/</guid><description>&lt;h3 id="adding-the-mouselight-open-data">Adding the MouseLight Open Data&lt;/h3>
&lt;p>The MouseLight project at Janelia has made available the complete imagery and neuron tracing annotations for its published data sets on the &lt;a href="https://registry.opendata.aws/janelia-mouselight/">AWS Open Data Registry&lt;/a>.&lt;/p>
&lt;p>You can easily make these available in your own HortaCloud instance by &lt;a href="https://hortacloud.org/docs/user_manual/synchronized_folders/">creating a Synchronized Folder&lt;/a> which points to &lt;code>/s3data/janelia-mouselight-data&lt;/code>.&lt;/p>
&lt;h3 id="adding-a-single-volume">Adding a single volume&lt;/h3>
&lt;p>A Horta Sample is an object representing a single 3D volume that can be visualized and traced with Horta.&lt;/p></description></item><item><title>Troubleshooting</title><link>https://hortacloud.org/docs/administration/aws/troubleshooting/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hortacloud.org/docs/administration/aws/troubleshooting/</guid><description>&lt;h2 id="no-user-can-login-to-the-workstation">No user can login to the workstation&lt;/h2>
&lt;p>We have seen this behavior if the &amp;ldquo;/data&amp;rdquo; volume ran out of space. You can check this by connecting to the EC2 instance running the JACS stack and running &lt;code>df -h /data&lt;/code>.&lt;/p>
&lt;p>If the disk is full you, you can try to find anything that could be removed but if the limit was reached because the size your data you really have to resize the volume. The steps to resize an EBS volume can be found in the AWS documentation. First run &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/requesting-ebs-volume-modifications.html">the instructions to increase the size of and EBS volume&lt;/a> and then &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html">the instructions that make the entire new disk space available to the EC2 instance&lt;/a>&lt;/p></description></item></channel></rss>