<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Two-server deployment | HortaCloud</title>
<meta name=description content="How to deploy Horta to a pair of servers
"><meta property="og:url" content="https://hortacloud.janelia.org/docs/administration/bare_metal/twoserverdeployment/"><meta property="og:site_name" content="HortaCloud"><meta property="og:title" content="Two-server deployment"><meta property="og:description" content="How to deploy Horta to a pair of servers"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-03-09T13:41:27-05:00"><meta itemprop=name content="Two-server deployment"><meta itemprop=description content="How to deploy Horta to a pair of servers"><meta itemprop=dateModified content="2023-03-09T13:41:27-05:00"><meta itemprop=wordCount content="884"><meta name=twitter:card content="summary"><meta name=twitter:title content="Two-server deployment"><meta name=twitter:description content="How to deploy Horta to a pair of servers"><link rel=preload href=/scss/main.min.55d6a7060342ee00f397dcdc958ab401a1e2a2a92d8baec7ba45906976f8ce8b.css as=style><link href=/scss/main.min.55d6a7060342ee00f397dcdc958ab401a1e2a2a92d8baec7ba45906976f8ce8b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>HortaCloud</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/about/><span>About</span></a></li><li class=nav-item><a class="nav-link active" href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.70da754132ce37b3d8be55530acebcca.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.70da754132ce37b3d8be55530acebcca.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoverview-li><a href=/docs/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsuser_manual-li><a href=/docs/user_manual/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsuser_manual><span>User manual</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualconcepts-li><a href=/docs/user_manual/concepts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualconcepts><span>Concepts</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualappstream_basics-li><a href=/docs/user_manual/appstream_basics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualappstream_basics><span>AppStream Basics</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-docsuser_manualtutorials-li><a href=/docs/user_manual/tutorials/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsuser_manualtutorials><span>Tutorials</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualtutorialslogging-in-li><a href=/docs/user_manual/tutorials/logging-in/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualtutorialslogging-in><span>Logging in</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualtutorialsviewing-images-li><a href=/docs/user_manual/tutorials/viewing-images/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualtutorialsviewing-images><span>Viewing images</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualtutorialstracing-neurons-li><a href=/docs/user_manual/tutorials/tracing-neurons/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualtutorialstracing-neurons><span>Tracing neurons</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualtutorialsimport-export-li><a href=/docs/user_manual/tutorials/import-export/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualtutorialsimport-export><span>Exporting and importing neurons</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualbasic_operations-li><a href=/docs/user_manual/basic_operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualbasic_operations><span>Basic Operations</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualfeatures-li><a href=/docs/user_manual/features/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualfeatures><span>Features</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualreference-li><a href=/docs/user_manual/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualreference><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualsynchronized_folders-li><a href=/docs/user_manual/synchronized_folders/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualsynchronized_folders><span>Synchronized Folders</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsuser_manualissues-li><a href=/docs/user_manual/issues/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser_manualissues><span>Reporting issues</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docsadministration-li><a href=/docs/administration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsadministration><span>Administration guide</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsadministrationaws-li><a href=/docs/administration/aws/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsadministrationaws><span>AWS</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawscosts-li><a href=/docs/administration/aws/costs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawscosts><span>Costs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawsdeployment-li><a href=/docs/administration/aws/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawsdeployment><span>Deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawsbackups-li><a href=/docs/administration/aws/backups/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawsbackups><span>Backup & Restore</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawsupgrading-li><a href=/docs/administration/aws/upgrading/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawsupgrading><span>Upgrading</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawsdata-li><a href=/docs/administration/aws/data/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawsdata><span>Data Import</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsadministrationawstroubleshooting-li><a href=/docs/administration/aws/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationawstroubleshooting><span>Troubleshooting</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docsadministrationbare_metal-li><a href=/docs/administration/bare_metal/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsadministrationbare_metal><span>Bare metal</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docsadministrationbare_metaltwoserverdeployment-li><a href=/docs/administration/bare_metal/twoserverdeployment/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metaltwoserverdeployment><span class=td-sidebar-nav-active-item>Two-server deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalfulldeployment-li><a href=/docs/administration/bare_metal/fulldeployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalfulldeployment><span>Three-server deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalinstallingdocker-li><a href=/docs/administration/bare_metal/installingdocker/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalinstallingdocker><span>Installing Docker</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalswarmdeployment-li><a href=/docs/administration/bare_metal/swarmdeployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalswarmdeployment><span>Deploying JACS</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalelkdeployment-li><a href=/docs/administration/bare_metal/elkdeployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalelkdeployment><span>Deploying ELK</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalselfsignedcerts-li><a href=/docs/administration/bare_metal/selfsignedcerts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalselfsignedcerts><span>Self-signed Certificates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metalstoragevolumes-li><a href=/docs/administration/bare_metal/storagevolumes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metalstoragevolumes><span>Storage volumes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metaldataimport-li><a href=/docs/administration/bare_metal/dataimport/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metaldataimport><span>Data import</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsadministrationbare_metaltroubleshooting-li><a href=/docs/administration/bare_metal/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsadministrationbare_metaltroubleshooting><span>Troubleshooting</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdevelopment-li><a href=/docs/development/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdevelopment><span>Developer's guide</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentgettingstarted-li><a href=/docs/development/gettingstarted/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentgettingstarted><span>Getting started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentcomposedeployment-li><a href=/docs/development/composedeployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentcomposedeployment><span>Single server deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-docsdevelopmentsystemoverview-li><a href=/docs/development/systemoverview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdevelopmentsystemoverview><span>System Overview</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentsystemoverviewpersistence-li><a href=/docs/development/systemoverview/persistence/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentsystemoverviewpersistence><span>Persistence</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentsystemoverviewtileimagery-li><a href=/docs/development/systemoverview/tileimagery/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentsystemoverviewtileimagery><span>Tiled Imagery</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentsystemovervieweventhandling-li><a href=/docs/development/systemoverview/eventhandling/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentsystemovervieweventhandling><span>Event Handling/Communication</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdevelopmentcontributing-li><a href=/docs/development/contributing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevelopmentcontributing><span>Contribution guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontribution-guidelines-li><a href=/docs/contribution-guidelines/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docscontribution-guidelines><span>Editing the documentation</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/JaneliaSciComp/hortacloud-website/tree/main/content/docs/administration/bare_metal/TwoServerDeployment.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/JaneliaSciComp/hortacloud-website/edit/main/content/docs/administration/bare_metal/TwoServerDeployment.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/JaneliaSciComp/hortacloud-website/new/main/content/docs/administration/bare_metal?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/JaneliaSciComp/hortacloud-website/issues/new?title=Two-server%20deployment" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/JaneliaSciComp/hortacloud/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=/docs/administration/bare_metal/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#deployment-diagram>Deployment Diagram</a></li><li><a href=#hardware-setup>Hardware Setup</a></li><li><a href=#install-oracle-linux-8>Install Oracle Linux 8</a></li><li><a href=#install-docker>Install Docker</a></li><li><a href=#setup-docker-swarm>Setup Docker Swarm</a></li><li><a href=#download-the-installer>Download the installer</a></li><li><a href=#configure-the-system>Configure The System</a></li><li><a href=#deploy-services>Deploy Services</a></li><li><a href=#import-imagery>Import Imagery</a></li><li><a href=#find-more-information>Find More Information</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Documentation</a></li><li class=breadcrumb-item><a href=/docs/administration/>Administration guide</a></li><li class=breadcrumb-item><a href=/docs/administration/bare_metal/>Bare metal</a></li><li class="breadcrumb-item active" aria-current=page>Two-server deployment</li></ol></nav><div class=td-content><h1>Two-server deployment</h1><div class=lead>How to deploy Horta to a pair of servers</div><header class=article-meta></header><p>This document describes the canonical two-server Janelia Workstation deployment for supporting neuron tracing for the <a href=https://www.janelia.org/project-team/mouselight>MouseLight project</a> at the Janelia Research Campus and other research institutions. This deployment uses Docker Swarm to orchestrate prebuilt containers available on Docker Hub.</p><h2 id=deployment-diagram>Deployment Diagram</h2><a href=../TwoServerDeployment.png><img src=../TwoServerDeployment.png class="rounded mx-auto" style=max-width:700px alt="two-server deployment diagram"></a><h2 id=hardware-setup>Hardware Setup</h2><p>The JACS backend consists of several services which need to be deployed on server hardware. We have tested the following configuration:</p><ul><li>Two Dell PowerEdge R740XD Servers<ul><li>Each server has 40 cores (e.g. Intel Xeon Gold 6148 2.4G)</li><li>Each server has 192 GB of memory</li><li>The hard drives are configured as follows:<ul><li>2 x 200GB SSD in RAID1 - Operating system (/)</li><li>2 x 960GB SSD in RAID1 - Databases, user preferences, etc. (/opt)</li><li>12 x 10TB in RAID6 - Image files (/data)</li></ul></li></ul></li></ul><p>The rest of this guide assumes that you have two server hosts dedicated to deploying this system, which are configured as listed above. They will be referred to as <strong>HOST1</strong> and <strong>HOST2</strong>.</p><p>This two-server deployment can support 5-10 concurrent users. We use the following configuration for client machines:</p><ul><li>Dell Precision 5820 Tower<ul><li>Minimum of 8 cores (e.g. Intel Xeon W-2145 3.7GHz)</li><li>128 GB of memory</li><li>Nvidia GTX1080Ti 11GB (reference card, blower fan style)<ul><li>Other similar cards will work fine: GTX1070, GTX1080, RTX2080</li></ul></li><li>Windows 10</li></ul></li></ul><h2 id=install-oracle-linux-8>Install Oracle Linux 8</h2><p>The backend software runs on any operating system which supports Docker. However, Oracle Linux is used at Janelia and has been extensively tested with this software. Therefore, we recommend installing the latest version of Oracle Linux 8.</p><h2 id=install-docker>Install Docker</h2><p>To install Docker and Docker Compose on Oracle Linux 8, follow <a href=../installingdocker>these instructions</a>.</p><h2 id=setup-docker-swarm>Setup Docker Swarm</h2><p>On <strong>HOST1</strong>, bring up swarm as a manager node:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker swarm init
</span></span></code></pre></div><p>On <strong>HOST2</strong>, copy and paste the output of the previous command to join the swarm as a worker.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker swarm join --token ...
</span></span></code></pre></div><p>All further commands should be executed on <strong>HOST1</strong>, i.e. the master node. One final step is to label the nodes. Each node needs the &ldquo;jacs=true&rdquo; label, as well as &ldquo;jacs_name=nodeX&rdquo;.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker node update --label-add <span style=color:#000>jacs_name</span><span style=color:#ce5c00;font-weight:700>=</span>node1 <span style=color:#204a87;font-weight:700>$(</span>docker node ls -f <span style=color:#4e9a06>&#34;role=manager&#34;</span> --format <span style=color:#4e9a06>&#34;{{.ID}}&#34;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>docker node update --label-add <span style=color:#000>jacs_name</span><span style=color:#ce5c00;font-weight:700>=</span>node2 <span style=color:#204a87;font-weight:700>$(</span>docker node ls -f <span style=color:#4e9a06>&#34;role=worker&#34;</span> --format <span style=color:#4e9a06>&#34;{{.ID}}&#34;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>docker node update --label-add <span style=color:#000>jacs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#204a87;font-weight:700>$(</span>docker node ls -f <span style=color:#4e9a06>&#34;role=manager&#34;</span> --format <span style=color:#4e9a06>&#34;{{.ID}}&#34;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>docker node update --label-add <span style=color:#000>jacs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#204a87;font-weight:700>$(</span>docker node ls -f <span style=color:#4e9a06>&#34;role=worker&#34;</span> --format <span style=color:#4e9a06>&#34;{{.ID}}&#34;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span></code></pre></div><p>Finally, you can run this command to ensure that both nodes are up and in Ready status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker node ls
</span></span></code></pre></div><h2 id=download-the-installer>Download the installer</h2><p>Download the installer and extract it onto the master node, as follows. <code>VERSION</code> should be set to the <a href=https://github.com/JaneliaSciComp/jacs-cm/releases>latest stable version</a> available on the releases page.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;version_number_here&gt;
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /opt
</span></span><span style=display:flex><span>sudo mkdir deploy
</span></span><span style=display:flex><span>sudo chown <span style=color:#000>$USER</span> deploy
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> deploy
</span></span><span style=display:flex><span>curl https://codeload.github.com/JaneliaSciComp/jacs-cm/tar.gz/<span style=color:#000>$VERSION</span> <span style=color:#000;font-weight:700>|</span> tar xvz
</span></span><span style=display:flex><span>ln -s jacs-cm-<span style=color:#000>$VERSION</span> jacs-cm
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> jacs-cm
</span></span></code></pre></div><h2 id=configure-the-system>Configure The System</h2><p>Next, create a <code>.env.config</code> file inside the intaller directory. This file defines the environment (usernames, passwords, etc.) You can copy the template to get started:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cp .env.template .env.config
</span></span><span style=display:flex><span>vi .env.config
</span></span></code></pre></div><p>At minimum, you must customize the following:</p><ol><li>Set <code>DEPLOYMENT</code> to <strong>mouselight</strong>.</li><li>Ensure that <code>REDUNDANT_STORAGE</code> and <code>NON_REDUNDANT_STORAGE</code> point to the disk mounts you used during the operating system installation. Alternatively, you can make symbolic links so that the default paths point to your mounted disks.</li><li>Set <code>HOST1</code> and <code>HOST2</code> to the two servers you are deploying on. Use fully-qualified hostnames here &ndash; they should match the SSL certificate you intend to use.</li><li>Fill in all the unset passwords with >8 character passwords. You should only use alphanumeric characters, special characters are not currently supported.</li><li>Generate 32-byte secret keys for JWT_SECRET_KEY, MONGODB_SECRET_KEY, JACS_API_KEY, and JADE_API_KEY.</li><li>If you want to enable automated error reporting from the Workstation client, set <code>MAIL_SERVER</code> to an SMTP server and port, e.g. smtp.my.org:25.</li></ol><h2 id=deploy-services>Deploy Services</h2><p>Now you can follow the <a href=../swarmdeployment>Swarm Deployment instructions</a> to actually deploy the software.</p><h2 id=import-imagery>Import Imagery</h2><p>If you have your own imagery, you will need to <a href=../dataimport>convert it</a> before importing.</p><p>Each brain image is referred to as a &ldquo;sample&rdquo;. You should place each sample in <code>$DATA_DIR/jacsstorage/samples</code> on one of the servers. If you place the sample on the first server, in <code>$DATA_DIR/jacsstorage/samples/&lt;sampleDirectoryName></code>, then in the Workstation you will refer to the sample as <code>/jade1/&lt;sampleDirectoryName></code>.</p><p>As a side note if you use &rsquo;lvDataImport&rsquo; service to generate the imagery, the service does not use JADE to persist the data. So if you need the data to be on a storage that is only accessible on certain hosts, JACS must run on that host in order to be able to write the data to the corresponding location. If that is not an option you can generate the data to a temporary location then move it to the intended sample directory.</p><p>In the Workstation, select <strong>File</strong> → <strong>New</strong> → <strong>Horta Sample</strong>, and then set &ldquo;Sample Name&rdquo; to <code>&lt;sampleDirectoryName></code> and &ldquo;Path to Render Folder&rdquo; as <code>/jade1/&lt;sampleDirectoryName></code>.</p><p>Open the Data Explorer (<strong>Window</strong> → <strong>Core</strong> → <strong>Data Explorer</strong>) and navigate to Home, then &ldquo;3D RawTile Microscope Samples&rdquo;, and your sample name. Right-click the sample and choose &ldquo;Open in Large Volume Viewer&rdquo;. The 2D imagery should load into the middle panel. You should be able to right-click anywhere on the image and select &ldquo;Navigate to This Location in Horta (channel 1)&rdquo;, to load the 3D imagery.</p><h2 id=find-more-information>Find More Information</h2><p>This concludes the MouseLight Workstation installation procedure. Further information on using the tools can be found in the <a href=../../../user_manual>User Manual</a>.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/JaneliaSciComp/hortacloud-website/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/JaneliaSciComp/hortacloud-website/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified March 9, 2023: <a href=https://github.com/JaneliaSciComp/hortacloud-website/commit/04bb4b0a504fa107667b278dedeaaa6d47e7c302>fixed menu item name (04bb4b0)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Email us" aria-label="Email us"><a target=_blank rel=noopener href=mailto:hortacloud@janelia.hhmi.org aria-label="Email us"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/HortaCloud aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Project management board" aria-label="Project management board"><a target=_blank rel=noopener href=https://github.com/orgs/JaneliaSciComp/projects/3 aria-label="Project management board"><i class="fas fa-tasks"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/JaneliaSciComp/hortacloud aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>Howard Hughes Medical Institute</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://www.hhmi.org/privacy-policy target=_blank rel=noopener>Privacy Policy & Cookie Notice</a></span></div></div></div></footer></div><script src=/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/tabpane-persist.js></script></body></html>